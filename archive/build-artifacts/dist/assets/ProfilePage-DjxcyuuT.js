import{c as S,r as i,e as ce,j as e,m as R,n as ie,ai as I,y as D,am as de,Q as f,S as j,$,a0 as H,K as C,T as L,a7 as g,a8 as y,a9 as b,M as N,N as w,ah as V}from"./index-DE73ohTM.js";import{T as oe,a as ue,b as E,d as A}from"./tabs-2Xit3JSY.js";import{C as me}from"./calendar-GYfL9xMG.js";import{S as xe}from"./save-uTHH2XyW.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=S("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=S("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=S("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=S("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=S("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var K={exports:{}},z={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v=i;function ve(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var ge=typeof Object.is=="function"?Object.is:ve,ye=v.useState,Ne=v.useEffect,we=v.useLayoutEffect,Se=v.useDebugValue;function _e(a,s){var t=s(),l=ye({inst:{value:t,getSnapshot:s}}),n=l[0].inst,r=l[1];return we(function(){n.value=t,n.getSnapshot=s,k(n)&&r({inst:n})},[a,t,s]),Ne(function(){return k(n)&&r({inst:n}),a(function(){k(n)&&r({inst:n})})},[a]),Se(t),t}function k(a){var s=a.getSnapshot;a=a.value;try{var t=s();return!ge(a,t)}catch{return!0}}function be(a,s){return s()}var Ce=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?be:_e;z.useSyncExternalStore=v.useSyncExternalStore!==void 0?v.useSyncExternalStore:Ce;K.exports=z;var Le=K.exports;function Ee(){return Le.useSyncExternalStore(Ae,()=>!0,()=>!1)}function Ae(){return()=>{}}var F="Avatar",[ke,Te]=ce(F),[Ie,G]=ke(F),O=i.forwardRef((a,s)=>{const{__scopeAvatar:t,...l}=a,[n,r]=i.useState("idle");return e.jsx(Ie,{scope:t,imageLoadingStatus:n,onImageLoadingStatusChange:r,children:e.jsx(R.span,{...l,ref:s})})});O.displayName=F;var Q="AvatarImage",W=i.forwardRef((a,s)=>{const{__scopeAvatar:t,src:l,onLoadingStatusChange:n=()=>{},...r}=a,u=G(Q,t),c=Re(l,r),o=ie(x=>{n(x),u.onImageLoadingStatusChange(x)});return I(()=>{c!=="idle"&&o(c)},[c,o]),c==="loaded"?e.jsx(R.img,{...r,ref:s,src:l}):null});W.displayName=Q;var J="AvatarFallback",X=i.forwardRef((a,s)=>{const{__scopeAvatar:t,delayMs:l,...n}=a,r=G(J,t),[u,c]=i.useState(l===void 0);return i.useEffect(()=>{if(l!==void 0){const o=window.setTimeout(()=>c(!0),l);return()=>window.clearTimeout(o)}},[l]),u&&r.imageLoadingStatus!=="loaded"?e.jsx(R.span,{...n,ref:s}):null});X.displayName=J;function B(a,s){return a?s?(a.src!==s&&(a.src=s),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Re(a,{referrerPolicy:s,crossOrigin:t}){const l=Ee(),n=i.useRef(null),r=l?(n.current||(n.current=new window.Image),n.current):null,[u,c]=i.useState(()=>B(r,a));return I(()=>{c(B(r,a))},[r,a]),I(()=>{const o=_=>()=>{c(_)};if(!r)return;const x=o("loaded"),h=o("error");return r.addEventListener("load",x),r.addEventListener("error",h),s&&(r.referrerPolicy=s),typeof t=="string"&&(r.crossOrigin=t),()=>{r.removeEventListener("load",x),r.removeEventListener("error",h)}},[r,t,s]),u}var Y=O,Z=W,ee=X;const ae=i.forwardRef(({className:a,...s},t)=>e.jsx(Y,{ref:t,className:D("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s}));ae.displayName=Y.displayName;const se=i.forwardRef(({className:a,...s},t)=>e.jsx(Z,{ref:t,className:D("aspect-square h-full w-full",a),...s}));se.displayName=Z.displayName;const re=i.forwardRef(({className:a,...s},t)=>e.jsx(ee,{ref:t,className:D("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s}));re.displayName=ee.displayName;function Ue(){var P,M,T,U;const{user:a,updateProfile:s,updatePassword:t}=de(),[l,n]=i.useState({full_name:((P=a==null?void 0:a.user_metadata)==null?void 0:P.full_name)||"",email:(a==null?void 0:a.email)||""}),[r,u]=i.useState({current:"",new:"",confirm:""}),[c,o]=i.useState(!1),[x,h]=i.useState(null),[_,p]=i.useState(null);if(!a)return e.jsx("div",{className:"container mx-auto p-6 max-w-4xl",children:e.jsx(f,{children:e.jsx(j,{className:"pt-6",children:e.jsx("p",{className:"text-center text-muted-foreground",children:"Загрузка..."})})})});const te=async()=>{p(null),h(null),o(!0);try{await s({full_name:l.full_name}),h("Профиль успешно обновлен")}catch(d){p(d.message||"Ошибка обновления профиля")}finally{o(!1)}},ne=async()=>{if(p(null),h(null),r.new!==r.confirm){p("Новые пароли не совпадают");return}if(r.new.length<8){p("Пароль должен содержать минимум 8 символов");return}o(!0);try{await t(r.current,r.new),h("Пароль успешно изменен"),u({current:"",new:"",confirm:""})}catch(d){p(d.message||"Ошибка изменения пароля")}finally{o(!1)}},le=d=>d?d.split(" ").map(m=>m[0]).join("").toUpperCase().substring(0,2):a.email.substring(0,2).toUpperCase();return e.jsx("div",{className:"container mx-auto p-6 max-w-4xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Профиль"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Управление личной информацией и настройками безопасности"})]}),x&&e.jsx($,{children:e.jsx(H,{children:x})}),_&&e.jsx($,{variant:"destructive",children:e.jsx(H,{children:_})}),e.jsx(f,{children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs(ae,{className:"h-24 w-24",children:[e.jsx(se,{src:(M=a.user_metadata)==null?void 0:M.avatar_url}),e.jsx(re,{className:"text-2xl",children:le((T=a.user_metadata)==null?void 0:T.full_name)})]}),e.jsx(C,{size:"icon",variant:"secondary",className:"absolute bottom-0 right-0 h-8 w-8 rounded-full",children:e.jsx(fe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-semibold",children:((U=a.user_metadata)==null?void 0:U.full_name)||a.email}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.email}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(L,{variant:"secondary",children:[e.jsx(je,{className:"mr-1 h-3 w-3"}),"Пользователь"]}),e.jsxs(L,{variant:"outline",children:[e.jsx(me,{className:"mr-1 h-3 w-3"}),"С ",new Date(a.created_at).toLocaleDateString("ru-RU")]})]})]})]})})}),e.jsxs(oe,{defaultValue:"profile",className:"w-full",children:[e.jsxs(ue,{className:"grid w-full grid-cols-3",children:[e.jsxs(E,{value:"profile",children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Профиль"]}),e.jsxs(E,{value:"security",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Безопасность"]}),e.jsxs(E,{value:"notifications",children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Уведомления"]})]}),e.jsxs(A,{value:"profile",className:"space-y-4",children:[e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(y,{children:"Личная информация"}),e.jsx(b,{children:"Обновите свою личную информацию и контактные данные"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"full_name",children:"Полное имя"}),e.jsx(w,{id:"full_name",value:l.full_name,onChange:d=>n(m=>({...m,full_name:d.target.value})),placeholder:"Ваше имя",disabled:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"email",children:"Email"}),e.jsx(w,{id:"email",type:"email",value:l.email,disabled:!0,className:"bg-secondary"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email нельзя изменить после регистрации"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(C,{onClick:te,disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Сохранение..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"mr-2 h-4 w-4"}),"Сохранить изменения"]})})})]})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(y,{children:"Информация об аккаунте"})}),e.jsx(j,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"ID пользователя"}),e.jsx("p",{className:"font-mono text-xs",children:a.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Роль"}),e.jsx("p",{className:"font-medium",children:"Пользователь"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Дата регистрации"}),e.jsx("p",{className:"font-medium",children:new Date(a.created_at).toLocaleDateString("ru-RU")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Последний вход"}),e.jsx("p",{className:"font-medium",children:a.last_sign_in_at?new Date(a.last_sign_in_at).toLocaleDateString("ru-RU"):"Н/Д"})]})]})})]})]}),e.jsxs(A,{value:"security",className:"space-y-4",children:[e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(y,{children:"Изменить пароль"}),e.jsx(b,{children:"Убедитесь, что ваш пароль надежный и безопасный"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"current_password",children:"Текущий пароль"}),e.jsx(w,{id:"current_password",type:"password",value:r.current,onChange:d=>u(m=>({...m,current:d.target.value})),disabled:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"new_password",children:"Новый пароль"}),e.jsx(w,{id:"new_password",type:"password",value:r.new,onChange:d=>u(m=>({...m,new:d.target.value})),disabled:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"confirm_password",children:"Подтвердите новый пароль"}),e.jsx(w,{id:"confirm_password",type:"password",value:r.confirm,onChange:d=>u(m=>({...m,confirm:d.target.value})),disabled:c})]}),e.jsx(C,{onClick:ne,disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"mr-2 h-4 w-4 animate-spin"}),"Изменение..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Изменить пароль"]})})]})]}),e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(y,{children:"Активные сессии"}),e.jsx(b,{children:"Управление устройствами, на которых выполнен вход"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Текущее устройство"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Последняя активность: сейчас"})]}),e.jsx(L,{children:"Активно"})]})})})]})]}),e.jsx(A,{value:"notifications",children:e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(y,{children:"Настройки уведомлений"}),e.jsx(b,{children:"Управление способами получения уведомлений"})]}),e.jsx(j,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Настройки уведомлений доступны в разделе Уведомления"})})]})})]})]})})}export{Ue as default};
