# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: Database error creating new user

## –ü—Ä–æ–±–ª–µ–º–∞

–î–∞–∂–µ Dashboard UI (—Å service_role –ø—Ä–∞–≤–∞–º–∏) –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —Å–µ—Ä—å–µ–∑–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —É—Ä–æ–≤–Ω–µ PostgreSQL.

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **Logs** ‚Üí **Postgres Logs**
3. –ù–∞–π–¥–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
4. –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `auth.users` –∏–ª–∏ `create user`

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- –û—à–∏–±–∫–∏ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
- –û—à–∏–±–∫–∏ constraints
- –û—à–∏–±–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- Missing columns/tables

---

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ auth —Å—Ö–µ–º—É

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ auth.users
SELECT EXISTS (
  SELECT FROM pg_tables
  WHERE schemaname = 'auth' 
  AND tablename = 'users'
) as users_table_exists;

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_schema = 'auth' 
AND table_name = 'users'
ORDER BY ordinal_position;

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä–∏–≥–≥–µ—Ä—ã
SELECT trigger_name, event_manipulation, action_statement
FROM information_schema.triggers
WHERE event_object_schema = 'auth' 
AND event_object_table = 'users';
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è PostgreSQL

```sql
-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
SELECT * FROM pg_extension 
WHERE extname IN ('pgcrypto', 'uuid-ossp', 'pgjwt');

-- –ï—Å–ª–∏ pgcrypto –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
CREATE EXTENSION IF NOT EXISTS pgcrypto;
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
```

---

## ‚úÖ –†–ï–®–ï–ù–ò–Ø

### –†–ï–®–ï–ù–ò–ï 1: –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ auth —Å—Ö–µ–º—É (–û–ü–ê–°–ù–û!)

‚ö†Ô∏è **–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!

```sql
-- –°–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–π—Ç–µ backup!

-- –£–¥–∞–ª–∏—Ç–µ –≤—Å–µ –∏–∑ auth.users (–µ—Å–ª–∏ –µ—Å—Ç—å)
TRUNCATE auth.users CASCADE;

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞
SELECT COUNT(*) FROM auth.users;
```

–ó–∞—Ç–µ–º –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–Ω–æ–≤–∞.

---

### –†–ï–®–ï–ù–ò–ï 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π Supabase –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç:

#### A. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –≤ Supabase

1. Dashboard ‚Üí **New Project**
2. –ù–∞–∑–≤–∞–Ω–∏–µ: `data-parse-desk-new`
3. Database Password: —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≥–¥–µ-–Ω–∏–±—É–¥—å
4. Region: –≤—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π
5. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç (–∑–∞–π–º–µ—Ç 2-3 –º–∏–Ω—É—Ç—ã)

#### B. –û–±–Ω–æ–≤–∏—Ç–µ .env

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –≤ Dashboard
2. Settings ‚Üí API
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
   - Project URL
   - anon/public key

4. –û–±–Ω–æ–≤–∏—Ç–µ `.env`:
```env
VITE_SUPABASE_URL="https://–ù–û–í–´–ô_URL.supabase.co"
VITE_SUPABASE_PUBLISHABLE_KEY="–ù–û–í–´–ô_KEY"
VITE_SUPABASE_PROJECT_ID="–ù–û–í–´–ô_ID"
```

#### C. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /Users/js/VendHub/data-parse-desk

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏–∏
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:
# supabase/migrations/20250116_collaboration_tables.sql
```

#### D. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–í –Ω–æ–≤–æ–º –ø—Ä–æ–µ–∫—Ç–µ:
1. Authentication ‚Üí Users ‚Üí Add user
2. Email: admin@test.com
3. Password: Vh311941990
4. Auto Confirm: ‚úÖ
5. Create user

**–≠—Ç–æ –¥–æ–ª–∂–Ω–æ —Å—Ä–∞–±–æ—Ç–∞—Ç—å!**

---

### –†–ï–®–ï–ù–ò–ï 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

–í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–µ–≤—ã—à–µ–Ω—ã –ª–∏–º–∏—Ç—ã Free tier:

1. Dashboard ‚Üí **Settings** ‚Üí **Billing**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - Database size
   - API requests
   - Auth users count

–ï—Å–ª–∏ –ª–∏–º–∏—Ç—ã –ø—Ä–µ–≤—ã—à–µ–Ω—ã - upgrade –ø–ª–∞–Ω –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç.

---

### –†–ï–®–ï–ù–ò–ï 4: –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É Supabase

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. Dashboard ‚Üí **Support**
2. –ò–ª–∏: https://github.com/supabase/supabase/discussions
3. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É:
   ```
   Failed to create user through Dashboard UI
   Error: Database error creating new user
   Project ID: uzcmaxfhfcsxzfqvaloz
   ```

---

## üÜò –í–†–ï–ú–ï–ù–ù–û–ï –†–ï–®–ï–ù–ò–ï: Mock Auth

–ü–æ–∫–∞ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ mock auth –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

### –°–æ–∑–¥–∞–π—Ç–µ `src/lib/mockAuth.ts`:

```typescript
export const mockAuthConfig = {
  enabled: true, // –í–∫–ª—é—á–∏—Ç—å mock auth
  user: {
    id: '00000000-0000-0000-0000-000000000001',
    email: 'admin@test.com',
    user_metadata: {
      full_name: 'Administrator'
    },
    app_metadata: {},
    aud: 'authenticated',
    created_at: new Date().toISOString()
  }
};
```

### –û–±–Ω–æ–≤–∏—Ç–µ AuthContext:

```typescript
// –í src/contexts/AuthContext.tsx

import { mockAuthConfig } from '@/lib/mockAuth';

// –í –Ω–∞—á–∞–ª–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
if (mockAuthConfig.enabled) {
  // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ mock user
  return mockAuthConfig.user;
}
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

–í –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - –≤–æ–∑–º–æ–∂–Ω–æ, —É–≤–∏–¥–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –æ—à–∏–±–∫—É
2. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π
