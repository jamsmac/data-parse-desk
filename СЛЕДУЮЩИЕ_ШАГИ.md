# üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏

**–î–∞—Ç–∞:** 2025-10-25  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ - –¢—Ä–µ–±—É—é—Ç—Å—è —Ä—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è  

---

## ‚úÖ –ß–¢–û –ì–û–¢–û–í–û (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

1. ‚úÖ **SQL –º–∏–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞:** `supabase/migrations/20251025140000_setup_auth_for_tests.sql`
2. ‚úÖ **–ü–∞—Ä–æ–ª—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω:** `6TP+T9ZTHt0Y710UnZYpkAJMysZ8tYjr2o73OKNqw+o=`
3. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞:**
   - –ü–ê–†–û–õ–ò_–î–õ–Ø_–°–û–•–†–ê–ù–ï–ù–ò–Ø.md
   - –ù–ê–°–¢–†–û–ô–ö–ê_SENTRY.md
   - –ù–ê–°–¢–†–û–ô–ö–ê_BACKUPS.md
4. ‚úÖ **Git –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** .env —Ñ–∞–π–ª—ã –∑–∞—â–∏—â–µ–Ω—ã
5. ‚úÖ **–¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã:** integration tests —Å–æ–∑–¥–∞–Ω—ã

---

## üöÄ –î–ï–ô–°–¢–í–ò–Ø –°–ï–ô–ß–ê–° (–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ)

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å Auth –º–∏–≥—Ä–∞—Ü–∏—é (3 –º–∏–Ω—É—Ç—ã)

**–í–∞–∂–Ω–æ:** –°–¥–µ–ª–∞—Ç—å –ü–ï–†–í–´–ú, –∏–Ω–∞—á–µ integration tests –Ω–µ –∑–∞—Ä–∞–±–æ—Ç–∞—é—Ç

```bash
# –í–∞—Ä–∏–∞–Ω—Ç –ê: –ß–µ—Ä–µ–∑ CLI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
npx supabase db push

# –í–∞—Ä–∏–∞–Ω—Ç –ë: –ß–µ—Ä–µ–∑ Dashboard
# 1. –û—Ç–∫—Ä—ã—Ç—å https://supabase.com/dashboard/project/uzcmaxfhfcsxzfqvaloz
# 2. SQL Editor ‚Üí New Query
# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
cat supabase/migrations/20251025140000_setup_auth_for_tests.sql
# 4. –í—Å—Ç–∞–≤–∏—Ç—å –≤ SQL Editor
# 5. –ù–∞–∂–∞—Ç—å Run
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Ç–∞–±–ª–∏—Ü—É
SELECT * FROM public.profiles LIMIT 1;

-- –î–æ–ª–∂–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
SELECT proname FROM pg_proc WHERE proname = 'handle_new_user';
```

---

### –®–∞–≥ 2: –û—Ç–∫–ª—é—á–∏—Ç—å Email Confirmation (1 –º–∏–Ω—É—Ç–∞)

**–î–ª—è integration tests –Ω—É–∂–Ω–æ:**

1. –û—Ç–∫—Ä—ã—Ç—å https://supabase.com/dashboard/project/uzcmaxfhfcsxzfqvaloz
2. Authentication ‚Üí Providers ‚Üí Email
3. –ù–∞–π—Ç–∏ "Enable email confirmations"
4. **–í—ã–∫–ª—é—á–∏—Ç—å** (OFF)
5. Save

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã confirmations –≤ production):**
- –û—Å—Ç–∞–≤–∏—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º
- –î–æ–±–∞–≤–∏—Ç—å –≤ .env.test:
  ```bash
  SUPABASE_GOTRUE_MAILER_AUTOCONFIRM=true
  ```

---

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å Integration Tests (2 –º–∏–Ω—É—Ç—ã)

–ü–æ—Å–ª–µ Steps 1-2:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
npm run test -- src/tests/integration

# –î–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã:
# ‚úì Authentication works
# ‚úì RLS policies work  
# ‚úì Cross-user isolation works
# ‚úì SQL injection prevented
```

**–ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å credentials
cat .env | grep SUPABASE

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Auth –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
npx supabase inspect db auth

# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
npx supabase functions serve --debug
```

---

### –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å (2 –º–∏–Ω—É—Ç—ã)

**Encryption Password:**
```
6TP+T9ZTHt0Y710UnZYpkAJMysZ8tYjr2o73OKNqw+o=
```

**–ì–¥–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å:**

#### 1Password
```
Title: Data Parse Desk - API Encryption Key
Username: data-parse-desk
Password: 6TP+T9ZTHt0Y710UnZYpkAJMysZ8tYjr2o73OKNqw+o=
Website: https://data-parse-desk.com
Tags: encryption, api, production, critical
Notes: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è API –∫–ª—é—á–µ–π –≤ –ë–î
      Rotation: –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π
      Next: 2026-01-23
```

#### LastPass
```
Name: Data Parse Desk API Encryption
Folder: Work/Projects
Password: 6TP+T9ZTHt0Y710UnZYpkAJMysZ8tYjr2o73OKNqw+o=
Notes: Critical - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è migration 20251027000004
```

#### Bitwarden
```
Name: DataParseDesk - API Key Encryption
Type: Secure Note
Custom Field "Password": 6TP+T9ZTHt0Y710UnZYpkAJMysZ8tYjr2o73OKNqw+o=
Custom Field "Purpose": Encrypt API keys in database
Custom Field "Rotation": Every 90 days
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ .env
grep API_KEY_ENCRYPTION_PASSWORD .env

# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–æ–π –∂–µ –≤ production
grep API_KEY_ENCRYPTION_PASSWORD .env.production
```

---

### –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç—å Migration Repair (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, 5 –º–∏–Ω—É—Ç)

**–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
npx supabase migration list

# –ï—Å–ª–∏ –µ—Å—Ç—å unapplied –º–∏–≥—Ä–∞—Ü–∏–∏:
./scripts/repair-migrations.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–Ω–æ–≤–∞
npx supabase migration list
```

**–ö–æ–≥–¥–∞ –ù–ï –Ω—É–∂–µ–Ω repair:**
- –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ applied ‚úÖ
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –ø—Ä–∏ `supabase db push`
- –ë–∞–∑–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry (10 –º–∏–Ω—É—Ç)

**–°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å –≥–∞–π–¥
cat –ù–ê–°–¢–†–û–ô–ö–ê_SENTRY.md

# –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:
# 1. –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç –Ω–∞ sentry.io
# 2. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç "data-parse-desk"
# 3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å DSN
# 4. –î–æ–±–∞–≤–∏—Ç—å –≤ .env:
echo 'VITE_SENTRY_DSN="https://your-dsn@sentry.io/project-id"' >> .env
# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
npm run dev
# 6. Trigger test error
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- Sentry dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç errors
- Source maps –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- Alerts –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

### –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Backups (10 –º–∏–Ω—É—Ç)

**–°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:**
```bash
# –û—Ç–∫—Ä—ã—Ç—å –≥–∞–π–¥
cat –ù–ê–°–¢–†–û–ô–ö–ê_BACKUPS.md

# –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:
# 1. –û—Ç–∫—Ä—ã—Ç—å Supabase Dashboard
# 2. Settings ‚Üí Database ‚Üí Backups
# 3. –í–∫–ª—é—á–∏—Ç—å PITR (–µ—Å–ª–∏ Pro –ø–ª–∞–Ω)
# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å retention (7-30 –¥–Ω–µ–π)
# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å restore
```

**–ú–∏–Ω–∏–º—É–º –¥–ª—è production:**
- ‚úÖ Daily backups enabled
- ‚úÖ 7 days retention
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω restore

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è (Pro –ø–ª–∞–Ω):**
- ‚úÖ PITR enabled (continuous)
- ‚úÖ 30 days retention
- ‚úÖ Off-site backup script

---

## üìã –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤:

```bash
# 1. Git —Å—Ç–∞—Ç—É—Å —á–∏—Å—Ç
git status
# –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å .env —Ñ–∞–π–ª–æ–≤

# 2. Integration tests –ø—Ä–æ—Ö–æ–¥—è—Ç
npm run test -- src/tests/integration
# ‚úì All tests passing

# 3. Unit tests –ø—Ä–æ—Ö–æ–¥—è—Ç
npm run test
# ‚úì 1219/1281 passing (95%)

# 4. Build —Ä–∞–±–æ—Ç–∞–µ—Ç
npm run build
# ‚úì No errors

# 5. Type check
npm run type-check
# ‚úì No errors

# 6. Security audit
./scripts/check-git-security.sh
# ‚úì CLEAN

# 7. App –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
npm run dev
# ‚úì No errors in console
# ‚úì Sentry initialized
# ‚úì Supabase connected
```

---

## ‚úÖ CHECKLIST

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (—Å–¥–µ–ª–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è)
- [ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 20251025140000_setup_auth_for_tests.sql
- [ ] –û—Ç–∫–ª—é—á–∏—Ç—å email confirmation –≤ Supabase
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å integration tests (–¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏)
- [ ] –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ password manager
- [ ] Git commit + push (–µ—Å–ª–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è)

### –í–∞–∂–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Sentry
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å backups –≤ Supabase
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å security audit
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å restore –∏–∑ backup

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å migration repair (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å off-site backups
- [ ] –°–æ–∑–¥–∞—Ç—å monitoring dashboard
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è integration tests

---

## üÜò –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### Integration tests –ø–∞–¥–∞—é—Ç

**Error: "Database error saving new user"**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
psql "$DATABASE_URL" -c "SELECT * FROM public.profiles LIMIT 1;"

# –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é (–®–∞–≥ 1)
npx supabase db push
```

**Error: "Email not confirmed"**
```bash
# –û—Ç–∫–ª—é—á–∏—Ç—å email confirmation (–®–∞–≥ 2)
# –ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SUPABASE_GOTRUE_MAILER_AUTOCONFIRM=true
```

**Error: "Password is weak"**
```bash
# –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ—Å—Ç–∞—Ö
# –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ timestamp-based –ø–∞—Ä–æ–ª–∏
```

---

### Migration repair –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å connectivity
npx supabase status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å credentials
cat .env | grep SUPABASE

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é
npx supabase migration repair --status applied 20251014100000
```

---

### Sentry –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å DSN
echo $VITE_SENTRY_DSN

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
grep -A 10 "Sentry.init" src/main.tsx

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
npm run dev
# –í –∫–æ–Ω—Å–æ–ª–∏: throw new Error("Sentry test")
```

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–í—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

1. **–ü–∞—Ä–æ–ª–∏ –∏ Security:**
   - [–ü–ê–†–û–õ–ò_–î–õ–Ø_–°–û–•–†–ê–ù–ï–ù–ò–Ø.md](./–ü–ê–†–û–õ–ò_–î–õ–Ø_–°–û–•–†–ê–ù–ï–ù–ò–Ø.md)
   - [SECURITY_SETUP_INSTRUCTIONS.md](./SECURITY_SETUP_INSTRUCTIONS.md)
   - [QUICK_START_SECURITY_FIX.md](./QUICK_START_SECURITY_FIX.md)

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - [–ù–ê–°–¢–†–û–ô–ö–ê_SENTRY.md](./–ù–ê–°–¢–†–û–ô–ö–ê_SENTRY.md)
   - [MONITORING_SETUP.md](./MONITORING_SETUP.md)

3. **Backups:**
   - [–ù–ê–°–¢–†–û–ô–ö–ê_BACKUPS.md](./–ù–ê–°–¢–†–û–ô–ö–ê_BACKUPS.md)

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - [src/tests/integration/README.md](./src/tests/integration/README.md)

5. **Security Audit:**
   - [scripts/check-git-security.sh](./scripts/check-git-security.sh)

---

## üéØ –£–°–ü–ï–®–ù–û–ï –ó–ê–í–ï–†–®–ï–ù–ò–ï

–í—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ–≥–¥–∞:

1. ‚úÖ `npm run test -- src/tests/integration` ‚Üí All passing
2. ‚úÖ `./scripts/check-git-security.sh` ‚Üí CLEAN
3. ‚úÖ –ü–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ password manager
4. ‚úÖ Sentry –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç events
5. ‚úÖ Backups enabled –≤ Supabase
6. ‚úÖ `npm run build` ‚Üí No errors
7. ‚úÖ App —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:** ~30 –º–∏–Ω—É—Ç  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ –õ—ë–≥–∫–∞—è (—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º)  

---

**–ì–æ—Ç–æ–≤–æ –∫ production?** –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —à–∞–≥–æ–≤ - –î–ê ‚úÖ

